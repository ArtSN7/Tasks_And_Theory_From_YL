<!-- Generated by https://github.com/rodion-gudz/YandexLyceumDocs -->

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Учебник | Введение в PyGame </title>
    <link rel="stylesheet" href="/css/client.css"/>
	<link rel="stylesheet" href="/css/material.css">
	<link rel="stylesheet" href="/css/prism.css"/>
</head>
<body>
	<div class="lesson-material">
		<div class="layout">
			<div class="layout__wrapper layout__wrapper_type_narrow layout__wrapper_fixed">
				<main class="layout__main">
					<div class="lesson-material__wrapper">
						<a class="nav-tab nav-tab_back nav-tab_view_button" href="../..">
						<span data-lego="react"
						      class="icon icon_type_arrow-short icon_direction_left icon_size_s nav-tab__arrow-icon"></span>
							<span class="nav-tab__inner">Урок PG. Введение</span>
						</a>
						<section class="lesson-material__content">
							<article class="material"><h1>Введение в&nbsp;Pygame</h1>
<section class="material__plan"><nav>
<ol>
<li><a class="material__link" href="#1">Введение</a></li>
<li><a class="material__link" href="#2">Pygame&nbsp;&mdash; самая популярная библиотека для разработки игр</a></li>
<li><a class="material__link" href="#3">Установка pygame</a></li>
<li><a class="material__link" href="#4">Hello, Pygame</a></li>
<li><a class="material__link" href="#5">Рисование</a></li>
<li><a class="material__link" href="#6">Цвета</a></li>
<li><a class="material__link" href="#7">Система координат</a></li>
<li><a class="material__link" href="#8">Surface, Rect</a></li>
<li><a class="material__link" href="#9">Функции рисования</a></li>
</ol>
</nav></section>
<section class="material__annotation">
<h2>Аннотация</h2>
<p>На&nbsp;этом занятии мы&nbsp;начинаем блок, посвященный созданию игр c&nbsp;помощью библиотеки pygame.</p>
</section>
<section class="material__chapter">
<h2 id="1">Введение</h2>
<p>В&nbsp;этом модуле вам предстоит написать игру.</p>
<p>С&nbsp;одной стороны, игры&nbsp;&mdash; дело несерьезное. Конференции и&nbsp;конкурсы программных проектов очень редко рассматривают такие работы.</p>
<p>С&nbsp;другой, разработка игр&nbsp;&mdash; это сложная задача, включающая в&nbsp;себя много процессов и&nbsp;требующая использовать различные технологии.</p>
<p>Можно утверждать, что любая <strong>игра&nbsp;&mdash; это Объекты + Графика + Физика + ...</strong></p>
<p>Для того чтобы было удобно программировать все это многообразие, используют фреймворки. Одним из&nbsp;самых известных и&nbsp;популярных фреймворков для разработки игр на&nbsp;Python является <img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-1.png" width="100" height="auto" />.</p>
</section>
<section class="material__chapter">
<h2 id="2">Pygame&nbsp;&mdash; самая популярная библиотека для разработки игр</h2>
<p>Разработка pygame началась в&nbsp;2000 году Питером Шиннерсом. Тогда он&nbsp;активно программировал на&nbsp;Си и&nbsp;познакомился с&nbsp;Python (версии 1.5.2) и&nbsp;библиотекой <a class="material__link" href="http://www.libsdl.org/" target="_blank" rel="noopener noreferrer">SDL</a>. В&nbsp;то&nbsp;время она была очень популярна, на&nbsp;ней разрабатывались сотни игр, в&nbsp;том числе коммерческих, и&nbsp;идея подключить ее&nbsp;к&nbsp;Python показалась ему очень интересной.</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-2.png" width="300" height="auto" /></div>
<p>Начиная примерно с&nbsp;2004-2005&nbsp;года, pygame поддерживается и&nbsp;развивается сообществом свободного программного обеспечения.</p>
<p>Pygame включает в&nbsp;себя все, что необходимо для разработки игр: удобную работу с&nbsp;графикой (например, поддержку спрайтов), c&nbsp;методами-детекторами столкновений, звук и&nbsp;многое другое.</p>
</section>
<section class="material__chapter">
<h2 id="3">Установка pygame</h2>
<p>Благодаря утилите pip, установить pygame очень просто:</p>
<pre><code>pip install pygame
</code></pre>
</section>
<section class="material__annotation">
<h2>Важно!</h2>
<p>На текущий момент (декабрь 2022 года) сайт с документацией pygame недоступен для просмотра из России. Официальная документация для pygame устанавливается вместе с библиотекой автоматически на ваш компьютер. Чтобы получить к ней доступ надо выполнить в терминале команду:</p>
<pre><code>python -m pygame.docs
</code></pre>
</section>
<section class="material__chapter">
<h2 id="4">Hello, Pygame</h2>
<p>Для начала работы нужно подключить модуль <var>pygame</var>, вызвать функцию <code>init()</code> и&nbsp;создать холст.</p>
<p>Например:</p>
<pre><code class="language-python">import pygame

if __name__ == '__main__':
    pygame.init()
    size = width, height = 800, 600
    screen = pygame.display.set_mode(size)
</code></pre>
<p>И&nbsp;теперь можно свободно рисовать, вернее, формировать кадр на&nbsp;холсте с&nbsp;именем <var>screen</var>.</p>
<p>Что&nbsp;же всегда волновало авторов компьютерных игр? Правильно, их&nbsp;очень заботила проблема сделать движения героев, смены кадров и&nbsp;прочие анимационные вещи плавными, то&nbsp;есть создать эффект анимации.</p>
<p>Для того чтобы движение объектов было плавным, pygame использует двойную буферизацию. Пока пользователь смотрит на&nbsp;один кадр, следующий уже строится в&nbsp;памяти, при этом у&nbsp;пользователя ничего не&nbsp;меняется. Как только новый кадр нарисован, он&nbsp;помещается на&nbsp;видимый экран. Это происходит очень быстро, и&nbsp;пользователь не&nbsp;видит процесса рисования, который на&nbsp;большой скорости обновления выглядит как мерцание.</p>
<p>Для пользователя смена изображений происходит мгновенно.</p>
<p>Функция <code>flip()</code> как раз и&nbsp;выполняет эту смену. Поэтому после отрисовки кадра обязательно требуется команда:</p>
<pre><code class="language-python">pygame.display.flip()
</code></pre>
<p>Давайте дождёмся того момента, когда пользователь закроет окно. Сделаем это так:</p>
<pre><code class="language-python">while pygame.event.wait().type != pygame.QUIT:
    pass
</code></pre>
<p>Мы&nbsp;подробно разберем условие этого цикла на&nbsp;следующем занятии.</p>
<p>После этого, в&nbsp;конце работы программы нужно вызвать функцию <code>quit()</code> модуля <var>pygame</var>.</p>
<p>Таким образом, самая простая корректная программа на&nbsp;<var>pygame</var> выглядит так:</p>
<pre><code class="language-python">import pygame

if __name__ == '__main__':
    # инициализация Pygame:
    pygame.init()
    # размеры окна: 
    size = width, height = 800, 600
    # screen &mdash; холст, на котором нужно рисовать:
    screen = pygame.display.set_mode(size)
    # формирование кадра:
    # команды рисования на холсте
    # ...
    # ...
    # смена (отрисовка) кадра:
    pygame.display.flip()
    # ожидание закрытия окна:
    while pygame.event.wait().type != pygame.QUIT:
        pass
    # завершение работы:
    pygame.quit()
</code></pre>
<p>Теперь вынесем рисование в&nbsp;отдельную функцию:</p>
<pre><code class="language-python">def draw(screen):
    screen.fill((0, 0, 0))
    font = pygame.font.Font(None, 50)
    text = font.render("Hello, Pygame!", True, (100, 255, 100))
    text_x = width // 2 - text.get_width() // 2
    text_y = height // 2 - text.get_height() // 2
    text_w = text.get_width()
    text_h = text.get_height()
    screen.blit(text, (text_x, text_y))
    pygame.draw.rect(screen, (0, 255, 0), (text_x - 10, text_y - 10,
                                           text_w + 20, text_h + 20), 1)
</code></pre>
<p>Теперь, если добавить вызов этой функции в&nbsp;основной цикл, мы&nbsp;получим результат:</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-3.png" width="502" height="auto" /></div>
<p><strong>Тренировочное задание.</strong> Попробуйте воспроизвести самостоятельно приведенный пример и&nbsp;напишите программу Hello, pygame.</p>
<p>Сама функция <code>draw()</code> содержит несколько новых команд, мы&nbsp;их&nbsp;рассмотрим в&nbsp;следующих разделах.</p>
</section>
<section class="material__chapter">
<h2 id="5">Рисование</h2>
<p>Конечно, при оценке игры в&nbsp;первую очередь смотрят на&nbsp;ее&nbsp;графику. Обычно в&nbsp;играх используют готовые изображения, которые загружаются из&nbsp;дополнительных файлов. Но&nbsp;на&nbsp;этом занятии мы&nbsp;принципиально не&nbsp;будем использовать изображения. Наша основная задача &laquo;привыкнуть&raquo; к&nbsp;экранным координатам и&nbsp;изучить возможности модуля <a class="material__link" href="https://www.pygame.org/docs/ref/draw.html#comment_pygame_draw_rect" target="_blank" rel="noopener noreferrer">draw</a>.</p>
</section>
<section class="material__chapter">
<h2 id="6">Цвета</h2>
<p>Давайте вспомним, как устроены цвета в&nbsp;компьютерном мире.</p>
<p>Рисование на&nbsp;экране в&nbsp;конечном итоге&nbsp;&mdash; это появление <strong>пикселей</strong> (точек) разного цвета. Практически все команды рисования принимают цвет в&nbsp;качестве параметра.</p>
<p>Цвета каждого пикселя на&nbsp;мониторах формируется тремя световыми источниками:</p>
<ul>
<li>Красным</li>
<li>Синим</li>
<li>Зеленым</li>
</ul>
<p>Каждая компонента-источник может иметь 256 градаций интенсивности (0&nbsp;&mdash; совсем не&nbsp;горит, 255&nbsp;&mdash; горит очень ярко).</p>
<p>Например,</p>
<p><strong>(0, 0, 0)</strong>&nbsp;&mdash; это черный цвет,</p>
<p><strong>(255, 255, 255)</strong>&nbsp;&mdash; белый цвет.</p>
<p>Вообще, все цвета, имеющие одинаковые значения компонент&nbsp;&mdash; серые разной интенсивности.</p>
<p><strong>(255, 0, 0)</strong>&nbsp;&mdash; красный,</p>
<p><strong>(255, 100, 100)</strong>&nbsp;&mdash; светло-красный.</p>
<p>Для цветов в&nbsp;pygame используется отдельный модуль <a class="material__link" href="https://www.pygame.org/docs/ref/color.html" target="_blank" rel="noopener noreferrer">Color</a>.</p>
<p>Цвета в&nbsp;pygame&nbsp;&mdash; это объекты типа <var>Color</var>. Их&nbsp;могут создавать конструкторы:</p>
<pre><code class="language-python">Color(name)       # строкой, например, "yellow"
Color(r, g, b, a) # красный, зеленый, синий и прозрачность
Color(rgbvalue)
</code></pre>
<p>Последний конструктор может принимать как число, соответствующее цвету, так и&nbsp;строки в&nbsp;HTML-формате (#rrggbbaa или #rrggbb).</p>
<p>Таким образом, для создания цветов можно использовать такой код:</p>
<pre><code class="language-python">lightred = pygame.Color(255, 255, 100)
darkgreen = pygame.Color('#008000')
yellow = pygame.Color('yellow')
</code></pre>
<p>В&nbsp;Интернете есть много <a class="material__link" href="https://yandex.ru/search/?text=RGB%20online&amp;lr=213" target="_blank" rel="noopener noreferrer">инструментов по&nbsp;RGB-представлению цветов</a>.</p>
<p>Полезно знать, что существуют и&nbsp;другие форматы представления цвета (не&nbsp;только RGB).</p>
<p>Очень важным является HSV формат (Hue, Saturation, Value&nbsp;&mdash; тон, насыщенность, значение) или HSB (Hue, Saturation, Brightness&nbsp;&mdash; тон, насыщенность, яркость).</p>
<p>Возможные значения в&nbsp;диапазонах: H = [0, 360], S = [0, 100], V = [0, 100].</p>
<p>Яркость и&nbsp;насыщенность задаются в&nbsp;процентах, оттенок&nbsp;&mdash; положением на&nbsp;цветовом круге:</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-4.png" width="300" height="auto" /></div>
<p>Использование такого формата позволяет удобно менять &laquo;освещенность&raquo;, не&nbsp;меняя оттенка. Например, квадрат с&nbsp;&laquo;тенью&raquo;</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-5.png" width="155" height="auto" /></div>
<p>можно нарисовать так:</p>
<pre><code class="language-python">def draw_square(screen):
    color = pygame.Color(50, 150, 50)
    # рисуем "тень"
    pygame.draw.rect(screen, color,
                     (20, 20, 100, 100), 0)
    hsv = color.hsva
    # увеличиваем параметр Value, который влияет на яркость
    color.hsva = (hsv[0], hsv[1], hsv[2] + 30, hsv[3])
    # рисуем сам объект
    pygame.draw.rect(screen, color, (10, 10, 100, 100), 0)
</code></pre>
<p>Но&nbsp;если сложные преобразования цветов не&nbsp;нужны, можно обойтись и&nbsp;триплетами.</p>
<p>Функции модуля <var>draw</var> принимают кортежи в&nbsp;качестве цвета, например:</p>
<pre><code class="language-python"># нарисуем красный квадрат
pygame.draw.rect(screen, (255, 0, 0), (10, 10, 100, 100), 0)
</code></pre>
<p><strong>Тренировочное задание.</strong> Выведите надпись &laquo;Hello, Pygame&raquo; в&nbsp;программе из&nbsp;предыдущего раздела <a class="material__link" href="https://yandex.ru/search/?text=цвет%20Яндекса&amp;lr=213" target="_blank" rel="noopener noreferrer">цветом Яндекса</a>.</p>
<p>Несмотря на&nbsp;то, что цвета можно создать с&nbsp;полупрозрачностью, рисование фигур модулем <var>draw</var> не&nbsp;поддерживает прозрачность.</p>
<p>Конечно, прозрачность в&nbsp;Pygame использовать возможно, но&nbsp;мы&nbsp;подробно поговорим об&nbsp;этом позже.</p>
</section>
<section class="material__chapter">
<h2 id="7">Система координат</h2>
<p>Экран pygame устроен обычно для компьютерных графических систем (и&nbsp;необычно для математиков). Точка (0;0)&nbsp;&mdash; в&nbsp;верхнем левом углу, а&nbsp;ось&nbsp;Y направлена вниз.</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/images/second-year/pygame-1/pygame-x-y.svg" width="680" height="auto" /></div>
</section>
<section class="material__chapter">
<h2 id="8">Surface, Rect</h2>
<p>В&nbsp;pygame рисование происходит на&nbsp;Surface. Хоть это слово дословно переводится как <strong>Поверхность</strong>, мы&nbsp;чаще будем использовать термин <strong>Холст</strong>. Объект именно этого класса возвращается методом <code>set_mode()</code> модуля <var>display</var>.</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/images/second-year/pygame-1/pygame-screen.svg" width="680" height="auto" /></div>
<p>Мы&nbsp;будем достаточно редко вызывать методы этого объекта, чаще передавать его в&nbsp;функции рисования модуля <var>draw</var>, но&nbsp;один метод используется чаще других.</p>
<p>При помощи метода <code>fill()</code> можно залить весь холст. Ему передается цвет заливки. Например,</p>
<pre><code class="language-python">screen.fill((255, 255, 255))
</code></pre>
<p>зальет весь холст белым.</p>
<p>В&nbsp;этот метод можно передать и&nbsp;прямоугольник, тогда будет залита только область, заданная прямоугольником.</p>
<p>Для представления прямоугольников в&nbsp;pygame используется класс <var>Rect</var>. Объекты этого класса можно создать при помощи конструкторов:</p>
<pre><code class="language-python">Rect(left, top, width, height)
Rect((left, top), (width, height))
Rect(rect) 
</code></pre>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/images/second-year/pygame-1/pygame-rect.svg" width="680" height="auto" /></div>
<p>Последний конструктор принимает в&nbsp;себя другой прямоугольник. При этом создается копия передаваемого прямоугольника.</p>
<p>Таким образом, для рисования красного квадрата на&nbsp;зеленом фоне можно написать:</p>
<pre><code class="language-python">screen.fill((0, 255, 0))
screen.fill(pygame.Color('red'), pygame.Rect(10, 10, 60, 60))
</code></pre>
<p>При программировании компьютерной графики прямоугольники встречаются очень часто, поэтому в&nbsp;pygame все функции, принимающие прямоугольники в&nbsp;качестве параметров, могут принимать и&nbsp;кортеж из&nbsp;четырех чисел. При этом прямоугольник будет создан &laquo;на&nbsp;лету&raquo;.</p>
<p>Например, последнюю строчку можно упростить:</p>
<pre><code class="language-python">screen.fill(pygame.Color('red'), (10, 10, 60, 60))
</code></pre>
<p>В&nbsp;pygame не&nbsp;предусмотрена специальная команда рисования пикселя, но&nbsp;ее&nbsp;можно сэмулировать методом <code>fill()</code>.</p>
<p>Например, код</p>
<pre><code class="language-python">for i in range(10000):
    screen.fill(pygame.Color('white'),
                (random.random() * width, 
                 random.random() * height, 1, 1))
</code></pre>
<p>выведет на&nbsp;черный экран 10&nbsp;тысяч случайных белых точек.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/pygame-1/pygame-1-dots.png" width="680" height="auto" /></div>
</section>
<section class="material__chapter">
<h2 id="9">Функции рисования</h2>
<p>Основные функции рисования фигур расположены в&nbsp;модуле <a class="material__link" href="https://www.pygame.org/docs/ref/draw.html#comment_pygame_draw_rect" target="_blank" rel="noopener noreferrer">draw</a>.</p>
<p>Функции очень похожи друг на&nbsp;друга. Практически всем функциям передается Surface-объект, цвет (или кортеж значений, его задающих) и&nbsp;параметры.</p>
<p>Для того чтобы нарисовать <strong>линию</strong>, применяют функцию</p>
<pre><code class="language-python">line(Surface, color, start_pos, end_pos, width=1)
</code></pre>
<p>Она принимает два кортежа, содержащие координаты начальной и&nbsp;конечной точек. Последний параметр задает толщину линии.</p>
<p>Для рисования <strong>прямоугольника</strong>, стороны которого параллельны осям координат, используют функцию</p>
<pre><code class="language-python">rect(Surface, color, Rect, width=0)
</code></pre>
<p>Если последний параметр не&nbsp;задан (тогда он&nbsp;по&nbsp;умолчанию равен нулю), рисуется залитый прямоугольник, иначе&nbsp;&mdash; только рамка. Заметим, что закрашенный прямоугольник быстрее рисовать методом <a class="material__link" href="https://www.pygame.org/docs/ref/surface.html#pygame.Surface.fill" target="_blank" rel="noopener noreferrer">fill()</a> холста. Вторым параметром метод <var>fill</var> принимает прямоугольник (<var>Rect</var>) (или кортеж, которым он&nbsp;задается).</p>
<p>Для рисования <strong>многоугольника (полигона)</strong> функции <code>polygon()</code> необходимо передать список его вершин.</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/image/pygame/pygame-1-9.png" width="600" height="auto" /></div>
<p>Разберитесь по&nbsp;<a class="material__link" href="https://www.pygame.org/docs/ref/draw.html" target="_blank" rel="noopener noreferrer">документации</a> с&nbsp;функциями рисования окружности, эллипса и&nbsp;дуг самостоятельно.</p>
<p>Давайте перейдем к&nbsp;практике.</p>
</section></article>
						</section>
					</div>
				</main>
			</div>
		</div>
<footer class="footer">
	<div class="footer__controls">
		<a rel="noopener noreferrer" target="_blank" class="footer__help-link"
		   href="https://yandex.ru/legal/lms_termsofuse/">Terms of use</a>
	</div>
	<div class="footer__copyright">
		<div>
			<div class="Markdown">
				<div class="paragraph">Generated by <a rel="noopener noreferrer" target="_blank"
				                                       class="footer__help-link"
				                                       href="https://github.com/rodion-gudz/YandexLyceumDocs">Yandex Lyceum Docs</a>
				</div>
			</div>
		</div>
	</div>
</footer>	</div>
	<script src="/js/prism.js"></script>
</body>
</html>