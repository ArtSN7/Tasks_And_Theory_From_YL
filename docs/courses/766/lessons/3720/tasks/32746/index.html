<!-- Generated by https://github.com/rodion-gudz/YandexLyceumDocs -->

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Задача "Волнение на море" </title>
    <link rel="stylesheet" href="/css/client.css"/>
	<link rel="stylesheet" href="/css/vendors.css">
	<link rel="stylesheet" href="/css/prism.css"/>
</head>
<body>
	<div class="layout">
		<div class="layout__wrapper layout__wrapper_type_narrow">
			<main class="layout__main"><a
					class="nav-tab nav-tab_back nav-tab_view_button"
					href="../.."><span data-lego="react"
			                           class="icon icon_type_arrow-short icon_direction_left icon_size_s nav-tab__arrow-icon"></span><span
					class="nav-tab__inner">Урок СР 2</span></a>
				<nav class="yd407c--arrow-navigation">
						<a class="yd407c--arrow-navigation__arrow yd407c--arrow-navigation__arrow_direction_left"
						   href="../32745">
                    <span data-lego="react"
                          class="icon icon_type_scroll icon_direction_left icon_size_l"></span></a>
				</nav>
				<header class="yde1c4--task-header">
					<h1 class="heading heading_level_1 yde1c4--task-header__heading">Волнение на море</h1>
					<div class="y43a24--task-info__tag">
						<span class="task-tag task-tag_type_individual-work task-tag_size_m"></span>
						<div class="y43a24--task-info__tag-name">Самостоятельная работа</div>
					</div>
				</header>
				<section class="y6c2ac--task-description">
					<article class="y6c2ac--task-description__content">
						<p></p>
<div class="problem-statement">
<div class="header">
<h1 class="title">Волнение на море</h1>
<table>
<tbody>
<tr class="time-limit">
<td class="property-title">Ограничение времени</td>
<td>1&nbsp;секунда</td>
</tr>
<tr class="memory-limit">
<td class="property-title">Ограничение памяти</td>
<td>64Mb</td>
</tr>
<tr class="input-file">
<td class="property-title">Ввод</td>
<td colspan="1">стандартный ввод или input.txt</td>
</tr>
<tr class="output-file">
<td class="property-title">Вывод</td>
<td colspan="1">weather.csv</td>
</tr>
</tbody>
</table>
</div>
<h2></h2>
<div class="legend"><!--l. 47-->
<p style="text-indent: 0em;">Я ни разу не видел, чтобы море около Острова Сокровищ было спокойно. Даже в ясные дни, когда солнце сияет ослепительно и воздух неподвижен, громадные валы с грохотом катятся на внешний берег. На острове едва ли существует такое место, где можно было бы укрыться от шума прибоя. <!--l. 48--></p>
<p style="text-indent: 0em;">Идя через лес, я слышал впереди не только беспрерывный грохот прибоя, но также шум ветвей и шелест листьев. Это означало, что сегодня морской бриз сильнее, чем обычно. <!--l. 49--></p>
<p style="text-indent: 0em;">Напишите программу, которая для заданной бухты и даты выведет прогноз волнения на море. <!--l.
      50--></p>
<p style="text-indent: 0em;">Вашей программе будет доступен файл с базой данных из трех таблиц с такой структурой (показана БД для примеров): <!--l. 51--></p>
<p style="text-indent: 0em;"><span style="font-weight: bold;">Bays</span><!--l. 52--></p>
<p style="text-indent: 0em;"><span style="font-style: italic;">id, title, side_id, depth, size</span><!--l. 53--></p>
<p style="text-indent: 0em;"><span style="font-weight: bold;">Sides</span><!--l. 54--></p>
<p style="text-indent: 0em;"><span style="font-style: italic;">id, title, terrain</span><!--l. 55--></p>
<p style="text-indent: 0em;"><span style="font-weight: bold;">Predictions</span><!--l. 56--></p>
<p style="text-indent: 0em;"><span style="font-style: italic;">id, date, time, side_id, waves, wind</span><!--l. 57--></p>
<p style="text-indent: 0em;"><img alt="PIC" src="https://contest.yandex.ru/testsys/statement-image?imageId=dc8c33434dcacee8ddff9e132eec1f571c9b2db1f063e5944721401546658073" /><!--l.
      58--></p>
<p style="text-indent: 0em;">Связи между таблицами: <!--l. 59--></p>
<p style="text-indent: 0em;"><img alt="PIC" src="https://contest.yandex.ru/testsys/statement-image?imageId=10159fe38fb3193e8cd218c337ca11f22bbd7e03dba8c023ff630b41dc407539" /><!--l.
      60--></p>
<p style="text-indent: 0em;">С каждой стороны может быть несколько бухт, для каждой бухты прогноз может содержать несколько времен.</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</div>
<h2>Формат ввода</h2>
<div class="input-specification">Вводится имя файла с БД, затем дата (целое число) и название стороны острова.</div>
<h2>Формат вывода</h2>
<div class="output-specification"><!--l. 66-->
<p style="text-indent: 0em;">В файл <span style="font-weight: bold;">weather.csv </span>выведите прогноз погоды для этого дня и для всех бухт этой стороны острова в порядке увеличения времени, бухты располагайте по алфавиту. <!--l. 67--></p>
<p style="text-indent: 0em;">Порядок вывода полей в файле (строку заголовков в файл писать не нужно): <!--l. 68--></p>
<p style="text-indent: 0em;"><span style="font-style: italic;">название бухты;время;волны;ветер</span><!--l. 69--></p>
<p style="text-indent: 0em;">Разделитель точка с запятой.</p>
<p></p>
<p></p>
<p></p>
</div>
<h3>Пример 1</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<pre>heavy_sea.db
9 N
</pre>
</td>
<td>
<pre>North Parking lot;6;storm;SE
North Parking lot;12;sea of troubles;S
North Parking lot;15;calm;S
North Parking lot;18;sea of troubles;W
Telescope;6;storm;SE
Telescope;12;sea of troubles;S
Telescope;15;calm;S
Telescope;18;sea of troubles;W

</pre>
</td>
</tr>
</tbody>
</table>
<h3>Пример 2</h3>
<table class="sample-tests">
<thead>
<tr>
<th>Ввод</th>
<th>Вывод</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<pre>sea.db
10 E
</pre>
</td>
<td>
<pre>Wooded Cape;6;calm;NWN
Wooded Cape;9;sea of troubles;NW

</pre>
</td>
</tr>
</tbody>
</table>
<h2>Примечания</h2>
<div class="notes">Файлы из примеров можно загрузить <a href="https://yastatic.net/s3/lyceum/task_files/2020_E2L2_GmaAE.zip">здесь</a>.</div>
</div>
								<h2>Решение</h2>
								<a class="nav-tab nav-tab_back nav-tab_view_button"
								   href="https://yastatic.net/s3/lyceum/files/b49b27bc-502b-4f41-ae9c-91d819684414/solution.py"><span data-lego="react"
								                                   class="icon icon_type_arrow-short icon_direction_down icon_size_s nav-tab__arrow-icon"></span><span
										class="nav-tab__inner">Скачать</span></a>
									<details>
										<summary>Код</summary>
										<pre class="language-python" style="border-radius: 15px"><code
												class="language-python">import csv
import sqlite3


with open('weather.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile, delimiter=';', quotechar='"', quoting=csv.QUOTE_MINIMAL)
    con = sqlite3.connect(input())
    cur = con.cursor()
    a = input().split()
    data = int(a[0])
    name_side = a[1]
    result = cur.execute(f"""SELECT DISTINCT
        Bays.title as название, Predictions.time as время, Predictions.waves as волны, Predictions.wind as ветер
    FROM 
        Bays
    INNER JOIN Sides ON Bays.side_id = Sides.Id 
    INNER JOIN Predictions ON Sides.Id = Predictions.side_id
    WHERE Predictions.date = {data} AND Sides.title LIKE '{name_side}%'
    ORDER BY Bays.title, Predictions.time;""").fetchall()
    for i in result:
        writer.writerow([i[0], i[1], i[2], i[3]])</code></pre>
									</details>
							</article>
				</section>
			</main>
		</div>
		<aside class="layout__active-area">
			<nav class="yd609d--task-group-navigation">
				<ul class="yd609d--task-group-navigation__groups">
						<li class="yd609d--task-group-navigation__group"><span
								class="task-tag task-tag_type_individual-work task-tag_size_l yd609d--task-group-navigation__tag"
								tabindex="8"></span>
							<ul class="yd609d--task-group-navigation__tasks">
									<li class="yd609d--task-group-navigation__task">
											<a class="yd609d--task-group-navigation__link"
											   href="../32744">
												<div class="indicator indicator_color_grey indicator_size_xs"></div>
											</a>
									</li>
									<li class="yd609d--task-group-navigation__task">
											<a class="yd609d--task-group-navigation__link"
											   href="../32745">
												<div class="indicator indicator_color_grey indicator_size_xs"></div>
											</a>
									</li>
									<li class="yd609d--task-group-navigation__task">
											<a class="yd609d--task-group-navigation__link  yd609d--task-group-navigation__link_checked"
											   href="../32746">
												<div class="indicator indicator_color_grey indicator_size_xs"></div>
											</a>
									</li>
							</ul>
						</li>
				</ul>
			</nav>
		</aside>
	</div>
	<script src="/js/prism.js"></script>
</body>
</html>