<!-- Generated by https://github.com/rodion-gudz/YandexLyceumDocs -->

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Учебник | Установка дополнительных компонентов. PyQTGraph </title>
    <link rel="stylesheet" href="/css/client.css"/>
	<link rel="stylesheet" href="/css/material.css">
	<link rel="stylesheet" href="/css/prism.css"/>
</head>
<body>
	<div class="lesson-material">
		<div class="layout">
			<div class="layout__wrapper layout__wrapper_type_narrow layout__wrapper_fixed">
				<main class="layout__main">
					<div class="lesson-material__wrapper">
						<a class="nav-tab nav-tab_back nav-tab_view_button" href="../..">
						<span data-lego="react"
						      class="icon icon_type_arrow-short icon_direction_left icon_size_s nav-tab__arrow-icon"></span>
							<span class="nav-tab__inner">Урок PyQTGraph</span>
						</a>
						<section class="lesson-material__content">
							<article class="material"><h1>QT. Установка дополнительных компонентов. PyQTGraph</h1>
<section class="material__plan"><nav>
<ol>
<li><a class="material__link" href="#1">PyQTGraph</a></li>
<li><a class="material__link" href="#2">Проигрывание музыки</a></li>
</ol>
</nav></section>
<section class="material__annotation">
<h2>Аннотация</h2>
<p>В&nbsp;уроке мы&nbsp;научимся пользоваться дополнительными компонентами PyQT на&nbsp;примере PyQTGraph&nbsp;&mdash; библиотеки для построения графиков. А&nbsp;еще научимся проигрывать музыку в&nbsp;своих приложениях.</p>
</section>
<section class="material__chapter">
<h2 id="1">PyQTGraph</h2>
<p>Несмотря на&nbsp;большое количество встроенных виджетов, их&nbsp;не&nbsp;всегда хватает для реализации всех задумок. Хорошая новость заключается в&nbsp;том, что PyQT позволяет создавать собственные виджеты со&nbsp;своими функциями. Некоторые разработчики выкладывают эти библиотеки в&nbsp;Интернет, чтобы их&nbsp;могли использовать другие люди. В&nbsp;этом уроке мы&nbsp;познакомимся с&nbsp;библиотекой <a class="material__link" href="http://www.pyqtgraph.org/" target="_blank" rel="noopener noreferrer">PyQTGraph</a>, которая включает в&nbsp;себя виджеты для работы с&nbsp;графиками.</p>
<p>Для установки библиотеки выполните стандартную команду в&nbsp;командной строке:</p>
<pre><code>pip install pyqtgraph
</code></pre>
<p>Затем советуем вам настроить QtDesigner для работы с&nbsp;этой библиотекой. Это&nbsp;&mdash; необязательное условие, работать с&nbsp;ней можно и&nbsp;&laquo;вручную&raquo;, как мы&nbsp;делали в&nbsp;самом первом уроке. Но&nbsp;это не&nbsp;столь удобно.</p>
<ol>
<li>Открываем новый виджет в&nbsp;QtDesigner и&nbsp;добавляем <strong>Graphics View</strong>.</li>
<li>Нажимаем на&nbsp;него правой кнопкой мыши и&nbsp;выбираем вкладку <strong>Преобразовать&nbsp;в...</strong> (Promote to...).</li>
<li>Заполняем поля, как показано на&nbsp;картинке:
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/pyqtgraph/qtgraph-1.png" width="480" height="auto" /></div>
</li>
<li>Нажимаем на&nbsp;кнопку &laquo;Добавить&raquo;, а&nbsp;затем&nbsp;&mdash; на&nbsp;кнопку &laquo;Преобразовать&raquo;.</li>
</ol>
<p>Если нам в&nbsp;следующий раз понадобится добавить такой&nbsp;же виджет, то&nbsp;мы&nbsp;сможем выбрать его из&nbsp;выпадающего меню <strong>Преобразовать&nbsp;в...</strong>.</p>
<p>Напишем программу, которая будет строить графики одной из&nbsp;трех функций в&nbsp;зависимости от&nbsp;выбранного Radio Button.</p>
<p>Сначала создадим интерфейс в&nbsp;QtDesigner, не&nbsp;забыв при этом выполнить преобразование Graphics View в&nbsp;наш Plot Widget.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/pyqtgraph/qtgraph-2.png" width="553" height="auto" /></div>
<p>Преобразуем его с&nbsp;помощью <strong>pyuic5</strong> и&nbsp;начнем выполнять построение.</p>
<pre><code class="language-python">import sys
from PyQt5.QtWidgets import QApplication, QWidget, QMainWindow
from ui import Ui_Form
 

class MyWidget(QMainWindow,Ui_Form):
    def __init__(self):
        super().__init__()
        self.setupUi(self)
        self.pushButton.clicked.connect(self.run)
        
    def run(self):
        if self.radioButton.isChecked():
            self.widget.clear()
            self.widget.plot([i for i in range(10)], [i for i in range(10)], pen='r')
        elif self.radioButton_2.isChecked():
            self.widget.clear()
            self.widget.plot([i for i in range(10)], [i ** 2 for i in range(10)], pen='g')
        elif self.radioButton_3.isChecked():
            self.widget.clear()
            self.widget.plot([i for i in range(10)], [i ** 3 for i in range(10)], pen='b')
 

app = QApplication(sys.argv)
ex = MyWidget()
ex.show()
sys.exit(app.exec_())
</code></pre>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/pyqtgraph/qtgraph-3.png" width="541" height="auto" /></div>
<p>Подробнее про модуль <var>pyqtgraph</var> можно почитать в&nbsp;его официальной <a class="material__link" href="https://pyqtgraph.readthedocs.io" target="_blank" rel="noopener noreferrer">документации</a>.</p>
</section>
<section class="material__chapter">
<h2 id="2">Проигрывание музыки</h2>
<p>Часто в&nbsp;программах хочется добавить какую-либо аудио-информацию. Злоупотреблять этим не&nbsp;следует, но&nbsp;работать со&nbsp;звуками надо уметь. Напишем простейшее приложение-плеер, который будет проигрывать одну песню. Создадим интерфейс нашего приложения в&nbsp;QtDesigner.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/pyqtgraph/qtgraph-4.png" width="441" height="auto" /></div>
<p>Для работы с&nbsp;музыкальными файлами нам понадобится импортировать виджет <strong>QtMultimedia</strong>, а&nbsp;чтобы получить полный путь к&nbsp;файлу&nbsp;&mdash; <strong>QtCore</strong>.</p>
<pre><code class="language-python">from PyQt5 import QtCore, QtMultimedia
</code></pre>
<p>Посмотрим, как выглядит наше приложение:</p>
<pre><code class="language-python">from player import Ui_Form
from PyQt5 import QtCore, QtMultimedia
from PyQt5.QtWidgets import QApplication, QMainWindow

class MyWidget(QMainWindow, Ui_Form):
    def __init__(self):
        super().__init__()
        self.setupUi(self)
        self.load_mp3('/Users/user/Documents/Yandex/FileLesson/test.mp3')
        self.playBtn.clicked.connect(self.player.play)
        self.pauseBtn.clicked.connect(self.player.pause)
        self.stopBtn.clicked.connect(self.player.stop)

    def load_mp3(self,filename):
        media = QtCore.QUrl.fromLocalFile(filename)
        content = QtMultimedia.QMediaContent(media)
        self.player = QtMultimedia.QMediaPlayer()
        self.player.setMedia(content)
        
app = QApplication(sys.argv)
ex = MyWidget()
ex.show()
sys.exit(app.exec_())
</code></pre>
<p>В&nbsp;нем всего две функции. Начнем с&nbsp;конца, с&nbsp;функции <var>load_mp3</var>. Она отвечает за&nbsp;загрузку музыкального файла и&nbsp;создание объекта <strong>плеера</strong>, в&nbsp;котором эта музыка будет содержаться.</p>
<p>Важно, что сначала мы&nbsp;передаем в&nbsp;эту функцию не&nbsp;название файла, а&nbsp;полный путь, после чего происходит &laquo;оборачивание&raquo; в&nbsp;формат <var>QUrl</var>. Затем создается медиа-объект, который помещается в&nbsp;плеер.</p>
<p>Во&nbsp;время инициализации, после того, как мы&nbsp;подключили наш интерфейс, мы&nbsp;вызываем эту функцию, и&nbsp;в&nbsp;нашем классе появится поле <var>player</var>. Затем необходимо лишь настроить кнопки, привязав к&nbsp;каждой из&nbsp;них соответствующую функцию нашего объекта. Функции объекта <var>player</var> достаточно очевидны по&nbsp;их&nbsp;названиям.</p>
</section></article>
						</section>
					</div>
				</main>
			</div>
		</div>
<footer class="footer">
	<div class="footer__controls">
		<a rel="noopener noreferrer" target="_blank" class="footer__help-link"
		   href="https://yandex.ru/legal/lms_termsofuse/">Terms of use</a>
	</div>
	<div class="footer__copyright">
		<div>
			<div class="Markdown">
				<div class="paragraph">Generated by <a rel="noopener noreferrer" target="_blank"
				                                       class="footer__help-link"
				                                       href="https://github.com/rodion-gudz/YandexLyceumDocs">Yandex Lyceum Docs</a>
				</div>
			</div>
		</div>
	</div>
</footer>	</div>
	<script src="/js/prism.js"></script>
</body>
</html>