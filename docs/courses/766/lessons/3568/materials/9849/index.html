<!-- Generated by https://github.com/rodion-gudz/YandexLyceumDocs -->

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Учебник | Введение во flask. Обработка HTML-форм </title>
    <link rel="stylesheet" href="/css/client.css"/>
	<link rel="stylesheet" href="/css/material.css">
	<link rel="stylesheet" href="/css/prism.css"/>
</head>
<body>
	<div class="lesson-material">
		<div class="layout">
			<div class="layout__wrapper layout__wrapper_type_narrow layout__wrapper_fixed">
				<main class="layout__main">
					<div class="lesson-material__wrapper">
						<a class="nav-tab nav-tab_back nav-tab_view_button" href="../..">
						<span data-lego="react"
						      class="icon icon_type_arrow-short icon_direction_left icon_size_s nav-tab__arrow-icon"></span>
							<span class="nav-tab__inner">Урок WEB. HTML</span>
						</a>
						<section class="lesson-material__content">
							<article class="material"><h1>Введение во&nbsp;flask. Обработка HTML-форм</h1>
<section class="material__plan"><nav>
<ol>
<li><a class="material__link" href="#1">Инструменты для разработки веб-приложений</a></li>
<li><a class="material__link" href="#2">Первая страница на&nbsp;Flask</a></li>
<li><a class="material__link" href="#3">Статический контент</a></li>
<li><a class="material__link" href="#4">Наведем красоты (чуть-чуть)</a></li>
<li><a class="material__link" href="#5">Передача параметров в&nbsp;адресной строке</a></li>
<li><a class="material__link" href="#6">Обработка форм</a></li>
</ol>
</nav></section>
<section class="material__annotation">
<h2>Аннотация</h2>
<p>Наконец-то мы&nbsp;добрались до&nbsp;момента, когда мы&nbsp;будем использовать не&nbsp;чужие веб-приложения, а&nbsp;писать свои. И&nbsp;уже очень скоро мы&nbsp;убедимся, что с&nbsp;помощью Python это делать достаточно просто (особенно с&nbsp;использованием дополнительных сторонних библиотек).</p>
</section>
<section class="material__chapter">
<h2 id="1">Инструменты для разработки веб-приложений</h2>
<p>В&nbsp;письме про окончание первого курса мы&nbsp;просили вас за&nbsp;лето познакомиться с&nbsp;языком разметки HTML. Вот ссылки на&nbsp;курсы, которые мы&nbsp;рекомендовали:</p>
<ul>
<li><a class="material__link" href="https://htmlacademy.ru/courses" target="_blank" rel="noopener noreferrer">Интерактивные онлайн-курсы HTML Academy</a></li>
<li><a class="material__link" href="https://getbootstrap.com/docs/4.2/getting-started/introduction/" target="_blank" rel="noopener noreferrer">Документация по фреймворку Bootstrap</a></li>
<li><a class="material__link" href="https://stepik.org/course/38218/promo" target="_blank" rel="noopener noreferrer">Веб-разработка для начинающих: HTML и CSS от Stepik</a></li>
<li><a class="material__link" href="https://stepik.org/course/2621/promo" target="_blank" rel="noopener noreferrer">ОСНОВЫ Html &amp; CSS от Stepik</a></li>
</ul>
<p>Если вдруг вы&nbsp;еще этого не&nbsp;сделали, отложите другие дела и&nbsp;посмотрите эти курсы. Дальше без базового знания HTML-разметки вам будет очень сложно разрабатывать собственные веб-приложения.</p>
<p>В&nbsp;настоящее время разрабатывать веб-приложения можно практически на&nbsp;любом языке программирования, для каждого из&nbsp;которых создано не&nbsp;по&nbsp;одному десятку библиотек, облегчающих те&nbsp;или иные аспекты написания веб-приложений.</p>
<p>Многие разработчики мобильных приложений и&nbsp;приложений для десктопа &laquo;хитрят&raquo; и&nbsp;в&nbsp;целях экономии времени и&nbsp;сил создают веб-приложения просто завернутые в&nbsp;веб-компоненту (встроенный браузер), где вся функциональность реализована, как совокупность веб-страниц.</p>
<p>Одной из&nbsp;сильных областей Python является достаточно простое создание веб-страниц. В&nbsp;принципе, веб-приложения на&nbsp;Python можно писать и&nbsp;без установки дополнительных библиотек, только средствами &laquo;из&nbsp;коробки&raquo;, так как интерпретатор поставляется со&nbsp;встроенным CGI (стандарт интерфейса, применяемого для связи внешней программы с&nbsp;веб-сервером) сервером. Для этого давайте создадим файл server.py и&nbsp;напишем там вот такой код:</p>
<pre><code class="language-python">from http.server import HTTPServer, CGIHTTPRequestHandler


server_address = ("", 8000)
httpd = HTTPServer(server_address, CGIHTTPRequestHandler)
httpd.serve_forever()
</code></pre>
<p>Этот код создает простейший веб-сервер, и&nbsp;если мы&nbsp;перейдем по&nbsp;адресу localhost:8000 (или 127.0.0.1:8000), то&nbsp;увидим список файлов той директории, в&nbsp;которой запущен наш сервер.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-3.png" width="680" height="auto" /></div>
<p>Адрес в&nbsp;командной строке localhost (или 127.0.0.1)&nbsp;&mdash; это адрес вашего компьютера для самого этого компьютера, а&nbsp;цифры после двоеточия показывают номер порта. Порт необходим для того, чтобы на&nbsp;одной машине можно было запустить несколько приложений, которые ожидают сообщений. Если утрировать, то&nbsp;ip-адрес&nbsp;&mdash; это адрес только до&nbsp;многоквартирного дома, а&nbsp;порт&nbsp;&mdash; номер квартиры. Номер порта&nbsp;&mdash; целое число от&nbsp;0&nbsp;до&nbsp;65536. Для многих протоколов прикладного уровня есть свои стандартные порты, например для HTTP чаще всего используются 80, 8000 и&nbsp;8080.</p>
<p>Для создания первой веб-страницы надо сделать еще несколько шагов. Давайте создадим рядом с&nbsp;нашим сервером папку с&nbsp;именем cgi-bin, внутри которой создадим скрипт с&nbsp;именем index.py следующего содержания:</p>
<pre><code class="language-python">print("Content-type: text/html; charset=utf-8")
print()
print("&lt;h1&gt;Hello, Yandex!&lt;/h1&gt;")
</code></pre>
<p>Теперь мы&nbsp;можем перейти по&nbsp;адресу localhost:8000/cgi-bin/index.py и&nbsp;увидеть результат выполнения нашего скрипта.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-4.png" width="680" height="auto" /></div>
<p>Как вы&nbsp;могли заметить, на&nbsp;деле такой подход к&nbsp;созданию веб-приложений излишен и&nbsp;неудобен, поэтому мы&nbsp;его применять не&nbsp;будем, а&nbsp;будем использовать гораздо более удобные инструменты, которые построены в&nbsp;том числе поверх только что рассмотренного механизма.</p>
<p>Для Python разработано достаточно большое количество библиотек, которые значительно упрощают процесс создания веб-страниц. Некоторые из&nbsp;этих библиотек большие (Django, Twisted), а&nbsp;некоторые (Bottle, Flask) значительно меньше (их&nbsp;еще называют микро-фреймворками).</p>
<p>С&nbsp;чем связан размер библиотек? С&nbsp;тем, насколько сильно библиотека управляет архитектурой вашей системы и&nbsp;поддерживает&nbsp;ее, насколько развиты ее&nbsp;подсистемы, например, интеграция с&nbsp;разными базами данных, настройками, файловыми хранилищами и&nbsp;т.&nbsp;д. Небольшие библиотеки всего лишь скрывают от&nbsp;вас сетевой уровень, давая вам возможность управлять формированием страницы в&nbsp;зависимости от&nbsp;параметров. Остальное вы&nbsp;должны реализовывать сами.</p>
</section>
<section class="material__chapter">
<h2 id="2">Первая страница на&nbsp;Flask</h2>
<p>Разумеется, наши веб-приложения не&nbsp;будут огромными, сразу делать корпоративные <a class="material__link" href="https://ru.wikipedia.org/wiki/Интранет" target="_blank" rel="noopener noreferrer">интранет</a> порталы&nbsp;&mdash; довольно-таки непростая задача. Мы&nbsp;начнем с&nbsp;ресурсов с&nbsp;небольшим количеством страниц и&nbsp;ограниченной функциональностью, чтобы рассмотреть лишь базовые механизмы того, как все работает. К&nbsp;счастью, ключевые принципы построения веб-приложений одинаковы вне зависимости от&nbsp;используемого фреймворка.</p>
<p>Для наших целей прекрасно подойдет микрофреймворк Flask. Он&nbsp;популярный, с&nbsp;хорошей документацией, легок в&nbsp;освоении и&nbsp;при этом вполне пригоден для создания больших промышленных веб-приложений. После его освоения вам не&nbsp;составит труда &laquo;пощупать&raquo; Bottle самостоятельно, так как принципы работы у&nbsp;них очень похожи, а&nbsp;затем перейти к&nbsp;другим библиотекам.</p>
<p>Flask не&nbsp;входит в&nbsp;стандартную библиотеку Python, чтобы установить его необходимо выполнить команду:</p>
<pre><code>pip install flask
</code></pre>
<p>После установки библиотеки давайте создадим наше первое веб-приложение на&nbsp;Flask:</p>
<pre><code class="language-python">from flask import Flask

app = Flask(__name__)


@app.route('/')
@app.route('/index')
def index():
    return "Привет, Яндекс!"


if __name__ == '__main__':
    app.run(port=8080, host='127.0.0.1')
</code></pre>
<p>Наш скрипт создает объект приложения как экземпляр класса <var>Flask</var>, который мы&nbsp;предварительно импортировали из&nbsp;пакета flask. Декораторы <code>app.route</code> над функцией <var>index</var> используются для регистрации нашей функции, как функции обратного вызова для определенных событий. В&nbsp;нашем случае создается связь между адресом (URL) в&nbsp;браузере ('/' и '/index') и&nbsp;функцией <var>index</var>. Это означает, что когда веб-браузер запрашивает один из&nbsp;этих двух URL-адресов, Flask будет вызывать эту функцию и&nbsp;передать возвращаемое значение обратно в&nbsp;браузер в&nbsp;качестве ответа.</p>
<p>Давайте запустим наш скрипт и&nbsp;перейдем на&nbsp;страницу http://127.0.0.1:8080, что соответствует URL '/', или на&nbsp;страницу http://127.0.0.1:8080/index, чтобы увидеть результат выполнения функции <var>index</var>.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-5.png" width="680" height="auto" /></div>
<p>С&nbsp;помощью декоратора <code>app.route</code> мы&nbsp;можем создавать сколько угодно страниц со&nbsp;своими собственными адресами. Давайте добавим еще одну страницу с&nbsp;обратным отсчетом:</p>
<pre><code class="language-python">@app.route('/countdown')
def countdown():
    countdown_list = [str(x) for x in range(10, 0, -1)]
    countdown_list.append('Пуск!')
    return '&lt;/br&gt;'.join(countdown_list)
</code></pre>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-6.png" width="680" height="auto" /></div>
</section>
<section class="material__chapter">
<h2 id="3">Статический контент</h2>
<p>Практически любой веб-сайт содержит большое количество разнообразного статического контента, к&nbsp;которому могут относиться следующие виды информации:</p>
<ul>
<li>Изображения</li>
<li>Таблицы стилей CSS</li>
<li>Шрифты</li>
<li>Файлы для скачивания</li>
<li>Файлы скриптов JavaScript</li>
<li>Музыка, видео</li>
<li>И&nbsp;т.&nbsp;д.</li>
</ul>
<p>Всю подобную информацию Flask по&nbsp;умолчанию ищет в&nbsp;директории static, поэтому давайте ее&nbsp;создадим. Для более аккуратной организации файлов рекомендуется создавать подпапки в&nbsp;static для каждого типа статического контента, который у&nbsp;вас есть, например, static/img, static/fonts и&nbsp;т.&nbsp;д.</p>
<p><strong>Важное замечание:</strong> если тут и&nbsp;далее после изменения что-то не&nbsp;отображается, возможно, вы&nbsp;не&nbsp;перезапустили ваше веб-приложение; запустили новую версию параллельно со&nbsp;старой и&nbsp;браузер посылает запросы именно предыдущей версии; или браузер закешировал какие-то данные (сохранил к&nbsp;себе, чтобы отдавать пользователю без запроса к&nbsp;серверу для ускорения работы). Чтобы это поправить, обновите страницу с&nbsp;очисткой кеша&nbsp;&mdash; Shift + F5.</p>
<p>Давайте разместим хорошо известную нам сову Риану на&nbsp;отдельной странице.</p>
<div class="material__content-positioner"><img class="material__illustration" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-7.jpeg" width="680" height="auto" /></div>
<p>Для этого в&nbsp;папке static создадим подпапку img, разместим там наше изображение, импортируем из&nbsp;модуля flask функцию <var>url_for</var>. И&nbsp;добавим в&nbsp;наше веб-приложение следующий код:</p>
<pre><code class="language-python">@app.route('/image_sample')
def image():
    return f'''&lt;img src="{url_for('static', filename='img/riana.jpg')}" 
           alt="здесь должна была быть картинка, но не нашлась"&gt;'''
</code></pre>
<p>Если&nbsp;бы название файла с&nbsp;картинкой было на&nbsp;русском языке, оно перекодировалось&nbsp;бы в&nbsp;коды символов Unicode, что можно увидеть, посмотрев код страницы в&nbsp;браузере.</p>
<p>В&nbsp;принципе, никто нам не&nbsp;запрещает написать путь к&nbsp;файлу вот так:</p>
<pre><code class="language-python">return '''&lt;img src="/static/img/riana.jpg" alt="здесь должна была быть картинка, но не нашлась"&gt;'''
</code></pre>
<p>Однако при создании даже небольшого проекта вы&nbsp;можете столкнуться с&nbsp;тем, что ваши пути перестанут работать, так как кто-то переопределил у&nbsp;микро-фреймворка параметр, отвечающий за&nbsp;местонахождение директории со&nbsp;статическими файлами, а&nbsp;наш первоначальный вариант сохранит работоспособность.</p>
<p>Точно по&nbsp;такому&nbsp;же принципу работает и&nbsp;остальной статический контент. Давайте рассмотрим еще один пример: сделаем обработчик <var>return_sample_page</var>, который вернет пользователю нашу первую HTML-страницу, сверстанную по&nbsp;всем правилам:</p>
<pre><code class="language-python">@app.route('/sample_page')
def return_sample_page():
    return """&lt;!doctype html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;title&gt;Привет, Яндекс!&lt;/title&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;h1&gt;Первая HTML-страница&lt;/h1&gt;
                  &lt;/body&gt;
                &lt;/html&gt;"""
</code></pre>
<p>А&nbsp;теперь давайте добавим css-файл, который заменит цвет текста на&nbsp;красный. Для этого создадим в&nbsp;папке css внутри папки со&nbsp;статическим контентом файл style.css со&nbsp;следующим текстом:</p>
<pre><code class="language-python">h1 {
   color: #d22e3a
}
</code></pre>
<p>Заменим возвращаемое значение&nbsp;на:</p>
<pre><code class="language-python">f"""&lt;!doctype html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;link rel="stylesheet" type="text/css" href="{url_for('static', filename='css/style.css')}" /&gt;
                    &lt;title&gt;Привет, Яндекс!&lt;/title&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;h1&gt;Первая HTML-страница&lt;/h1&gt;
                  &lt;/body&gt;
                &lt;/html&gt;"""
</code></pre>
<p>Перезапустим приложение, обновим страницу и&nbsp;убедимся, что цвет текста изменился на&nbsp;указанный.</p>
</section>
<section class="material__chapter">
<h2 id="4">Наведем красоты (чуть-чуть)</h2>
<p>Наш курс ориентирован на&nbsp;изучение технологий, которые используются при создании промышленных приложений, и, к&nbsp;сожалению, создание стилей и&nbsp;верстка HTML&nbsp;не входит в&nbsp;цели нашего курса (да&nbsp;и&nbsp;просто времени не&nbsp;хватит, так как это отдельная большая тема). Но, согласитесь, хочется как-то относительно просто делать веб-приложения, которые выглядят симпатично, поэтому давайте обратимся к&nbsp;такому набору инструментов, как Bootstrap.</p>
<p>Bootstrap&nbsp;&mdash; это свободный набор инструментов для создания сайтов и&nbsp;веб-приложений, который включает в&nbsp;себя скрипты, стили, иконки и&nbsp;многое другое. Набор расширяемый и&nbsp;достаточно гибкий. Кроме того, у&nbsp;него огромное сообщество, которое предлагает большое количество уже готовых тем и&nbsp;компонентов для Bootstrap, большая часть которых либо свободно распространяемая, либо бесплатная, либо стоит не&nbsp;запредельно много даже по&nbsp;меркам бюджета школьного/студенческого проекта.</p>
<p>В&nbsp;своем первоначальном виде Bootstrap частенько используется программистами как отправная точка для создания веб-приложения без участия дизайнеров и&nbsp;верстальщиков. Инструкцию по&nbsp;подключению и&nbsp;использованию Bootstrap можно найти на&nbsp;<a class="material__link" href="https://getbootstrap.com/" target="_blank" rel="noopener noreferrer">официальном сайте</a>. Само подключение состоит из&nbsp;нескольких частей:</p>
<ul>
<li>Подключение стилей</li>
<li>Подключение JavaScript</li>
</ul>
<p>Для нашего следующего примера достаточно подключить только стили, но&nbsp;для использования всех возможностей Bootstrap необходимо выполнить оба шага.</p>
<p>Давайте сделаем функцию, которая будет нам отдавать простую страничку с&nbsp;подключением Bootstrap и&nbsp;несколькими элементами на&nbsp;ней. Примерно вот так:</p>
<pre><code class="language-python">@app.route('/bootstrap_sample')
def bootstrap():
    return '''&lt;!doctype html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
                    &lt;link rel="stylesheet" 
                    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" 
                    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" 
                    crossorigin="anonymous"&gt;
                    &lt;title&gt;Привет, Яндекс!&lt;/title&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;h1&gt;Привет, Яндекс!&lt;/h1&gt;
                    &lt;div class="alert alert-primary" role="alert"&gt;
                      А мы тут компонентами Bootstrap балуемся
                    &lt;/div&gt;
                  &lt;/body&gt;
                &lt;/html&gt;'''
</code></pre>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-1-8.png" width="680" height="auto" /></div>
<p>Как вы&nbsp;могли заметить, даже создание простых страниц напрямую из&nbsp;кода выглядит громоздко, а&nbsp;при небольшом увеличении сложности страницы трудоемкость написания и&nbsp;поддержки возрастает значительно. Поэтому вариант, который мы&nbsp;сегодня рассматривали, годится только для того, чтобы попрактиковаться с&nbsp;библиотекой и&nbsp;языком разметки HTML. На&nbsp;следующем уроке мы&nbsp;рассмотрим, как решается эта проблема.</p>
<p>Сейчас&nbsp;же мы&nbsp;добавим в&nbsp;наше приложение некоторую динамику путем передачи информации от&nbsp;пользователя на&nbsp;сервер. В&nbsp;общем-то, мы&nbsp;можем влиять на&nbsp;состояние сервера и&nbsp;сейчас, например, изменяя значение глобальной переменной:</p>
<pre><code class="language-python">from flask import Flask, url_for
i = 0
app = Flask(__name__)


@app.route('/i')
def show_i():
    global i
    i += 1
    return str(i)
</code></pre>
<p>Но&nbsp;это плохая практика, не&nbsp;делайте так, если от&nbsp;этого не&nbsp;зависит ваша жизнь. Единственное, на&nbsp;что можно обратить внимание в&nbsp;этом примере, это тот факт, что если мы&nbsp;попробуем возвратить этой функцией просто число, то&nbsp;получим страницу с&nbsp;ошибкой следующего содержания:</p>
<pre><samp>TypeError: 'int' object is not callable
The view function did not return a valid response.
The return type must be a string, tuple, Response instance,
or WSGI callable, but it was a int.</samp></pre>
<p>Данное сообщение недвусмысленно намекнет нам на&nbsp;то, каким может быть возвращаемое значение у&nbsp;функций, украшенных декоратором <code>app.route</code>.</p>
</section>
<section class="material__chapter">
<h2 id="5">Передача параметров в&nbsp;адресной строке</h2>
<p>Статичные страницы делать не&nbsp;интересно, поэтому давайте рассмотрим&nbsp;то, как мы&nbsp;можем взаимодействовать с&nbsp;пользователем нашего веб-приложения. Таких способов несколько, давайте начнем с&nbsp;передачи параметров в&nbsp;адресной строке.</p>
<p>Декоратор <code>app.route</code> умеет принимать на&nbsp;вход значение одного или нескольких параметров, которые пишется после завершающего слэша в&nbsp;пути внутри треугольных скобок &lt;&gt;, вот так:</p>
<pre><code class="language-python">@app.route('/greeting/&lt;username&gt;')
def greeting(username):
    return f'''&lt;!doctype html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
                   &lt;link rel="stylesheet"
                   href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
                   integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
                   crossorigin="anonymous"&gt;
                    &lt;title&gt;Привет, {username}&lt;/title&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;h1&gt;Привет, {username}!&lt;/h1&gt;
                  &lt;/body&gt;
                &lt;/html&gt;'''
</code></pre>
<p>Обратите внимание, что в&nbsp;данном случае меняется и&nbsp;сигнатура функции, которая теперь принимает на&nbsp;вход одноименный параметр. Кроме того, этот параметр&nbsp;&mdash; обязательный.</p>
<p>Flask позволяет указывать несколько параметров, а&nbsp;также явно определять их&nbsp;тип с&nbsp;помощью конвертера. Рассмотрим обе этих возможности в&nbsp;следующем примере:</p>
<pre><code class="language-python">@app.route('/two_params/&lt;username&gt;/&lt;int:number&gt;')
def two_params(username, number):
    return f'''&lt;!doctype html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
                    &lt;link rel="stylesheet"
                   href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
                   integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
                   crossorigin="anonymous"&gt;
                    &lt;title&gt;Пример с несколькими параметрами&lt;/title&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;h2&gt;{username}&lt;/h2&gt;
                    &lt;div&gt;Это первый параметр и его тип: {str(type(username))[1:-1]}&lt;/div&gt;
                    &lt;h2&gt;{number}&lt;/h2&gt;
                    &lt;div&gt;Это второй параметр и его тип: {str(type(number))[1:-1]}&lt;/div&gt;
                  &lt;/body&gt;
                &lt;/html&gt;'''
</code></pre>
<p>Всего таких конвертеров пять:</p>
<div class="material__content-positioner">
<table style="border-collapse: collapse; width: 100%;" border="1" cellpadding="5px">
<thead>
<tr>
<th>Имя конвертера</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>(по умолчанию) любой текст без слешей</td>
</tr>
<tr>
<td>int</td>
<td>положительное целое число</td>
</tr>
<tr>
<td>float</td>
<td>положительное дробное число</td>
</tr>
<tr>
<td>path</td>
<td>строка, но&nbsp;может содержать слеши, для передачи некоторого URL-пути</td>
</tr>
<tr>
<td>uuid</td>
<td>стандарт строк-идентификаторов из&nbsp;16&nbsp;байт в&nbsp;шестнадцатеричном представлении. Выглядит примерно так:<br />550e8400-e29b-41d4-a716-446655440000</td>
</tr>
</tbody>
</table>
</div>
<p>Передача параметров в&nbsp;адресе командной строки используется достаточно часто для динамического формирования однотипных страниц. Например, на&nbsp;сайте pypi.org такой способ применяется для формирования страниц с&nbsp;информацией о&nbsp;каждом конкретном модуле.</p>
</section>
<section class="material__chapter">
<h2 id="6">Обработка форм</h2>
<p>Передача параметра в&nbsp;адресной строке&nbsp;&mdash; это скорее не&nbsp;инструмент взаимодействия с&nbsp;пользователем, а&nbsp;динамическое формирование для него ссылок на&nbsp;разные объекты внутри веб-приложения. Для непосредственного общения с&nbsp;пользователем такой способ неудобен, так как в&nbsp;общем случае параметров может быть много, а&nbsp;предлагать пользователю заносить их&nbsp;в&nbsp;адресную строку руками&nbsp;&mdash; не&nbsp;лучшая идея.</p>
<p>Для взаимодействия с&nbsp;пользователем применяется другой механизм&nbsp;&mdash; формы. HTML-разметка позволяет создавать элементы для ввода данных разных типов, с&nbsp;которыми Flask, конечно, умеет работать. Давайте вспомним, какие типы элементов ввода поддерживает HTML.</p>
<p>Вообще говоря, разных типов полей ввода довольно много, и&nbsp;периодически в&nbsp;новые версии языка разметки добавляются дополнительные. Вот некоторые из&nbsp;таких типов:</p>
<ul>
<li>button&nbsp;&mdash; кнопка</li>
<li>checkbox&nbsp;&mdash; множественный выбор</li>
<li>color&nbsp;&mdash; поле выбора цвета</li>
<li>date, datetime, datetime-local, month, time, week&nbsp;&mdash; ввод даты и&nbsp;времени</li>
<li>email&nbsp;&mdash; поле для ввода адреса электронной почты</li>
<li>file&nbsp;&mdash; поле для выбора файла</li>
<li>number&nbsp;&mdash; поле для ввода числовой информации</li>
<li>password&nbsp;&mdash; поле для ввода пароля</li>
<li>radio&nbsp;&mdash; выбор одного из&nbsp;нескольких вариантов</li>
<li>range&nbsp;&mdash; ползунок (как в&nbsp;музыкальном или видео-плеере)</li>
<li>submit&nbsp;&mdash; кнопка для отправки формы</li>
<li>tel&nbsp;&mdash; поле для ввода телефона</li>
<li>text&nbsp;&mdash; поле для ввода текста</li>
<li>url&nbsp;&mdash; поле для ввода адреса в&nbsp;Интернете</li>
</ul>
<p>Давайте сделаем форму с&nbsp;несколькими самыми распространенными типами полей ввода, для их&nbsp;стилизации используем Bootstrap. Чтобы увидеть, в&nbsp;каком виде информация из&nbsp;этих полей придет на&nbsp;сервер нашего веб-приложения, напишем такой код (предварительно импортировав request из&nbsp;Flask):</p>
<pre><code class="language-python">@app.route('/form_sample', methods=['POST', 'GET'])
def form_sample():
    if request.method == 'GET':
        return f'''&lt;!doctype html&gt;
                        &lt;html lang="en"&gt;
                          &lt;head&gt;
                            &lt;meta charset="utf-8"&gt;
                            &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
                            &lt;link rel="stylesheet"
                            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
                            integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
                            crossorigin="anonymous"&gt;
                            &lt;link rel="stylesheet" type="text/css" href="{url_for('static', filename='css/style.css')}" /&gt;
                            &lt;title&gt;Пример формы&lt;/title&gt;
                          &lt;/head&gt;
                          &lt;body&gt;
                            &lt;h1&gt;Форма для регистрации в суперсекретной системе&lt;/h1&gt;
                            &lt;div&gt;
                                &lt;form class="login_form" method="post"&gt;
                                    &lt;input type="email" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Введите адрес почты" name="email"&gt;
                                    &lt;input type="password" class="form-control" id="password" placeholder="Введите пароль" name="password"&gt;
                                    &lt;div class="form-group"&gt;
                                        &lt;label for="classSelect"&gt;В каком вы классе&lt;/label&gt;
                                        &lt;select class="form-control" id="classSelect" name="class"&gt;
                                          &lt;option&gt;7&lt;/option&gt;
                                          &lt;option&gt;8&lt;/option&gt;
                                          &lt;option&gt;9&lt;/option&gt;
                                          &lt;option&gt;10&lt;/option&gt;
                                          &lt;option&gt;11&lt;/option&gt;
                                        &lt;/select&gt;
                                     &lt;/div&gt;
                                    &lt;div class="form-group"&gt;
                                        &lt;label for="about"&gt;Немного о себе&lt;/label&gt;
                                        &lt;textarea class="form-control" id="about" rows="3" name="about"&gt;&lt;/textarea&gt;
                                    &lt;/div&gt;
                                    &lt;div class="form-group"&gt;
                                        &lt;label for="photo"&gt;Приложите фотографию&lt;/label&gt;
                                        &lt;input type="file" class="form-control-file" id="photo" name="file"&gt;
                                    &lt;/div&gt;
                                    &lt;div class="form-group"&gt;
                                        &lt;label for="form-check"&gt;Укажите пол&lt;/label&gt;
                                        &lt;div class="form-check"&gt;
                                          &lt;input class="form-check-input" type="radio" name="sex" id="male" value="male" checked&gt;
                                          &lt;label class="form-check-label" for="male"&gt;
                                            Мужской
                                          &lt;/label&gt;
                                        &lt;/div&gt;
                                        &lt;div class="form-check"&gt;
                                          &lt;input class="form-check-input" type="radio" name="sex" id="female" value="female"&gt;
                                          &lt;label class="form-check-label" for="female"&gt;
                                            Женский
                                          &lt;/label&gt;
                                        &lt;/div&gt;
                                    &lt;/div&gt;
                                    &lt;div class="form-group form-check"&gt;
                                        &lt;input type="checkbox" class="form-check-input" id="acceptRules" name="accept"&gt;
                                        &lt;label class="form-check-label" for="acceptRules"&gt;Готов быть добровольцем&lt;/label&gt;
                                    &lt;/div&gt;
                                    &lt;button type="submit" class="btn btn-primary"&gt;Записаться&lt;/button&gt;
                                &lt;/form&gt;
                            &lt;/div&gt;
                          &lt;/body&gt;
                        &lt;/html&gt;'''
    elif request.method == 'POST':
        print(request.form['email'])
        print(request.form['password'])
        print(request.form['class'])
        print(request.form['file'])
        print(request.form['about'])
        print(request.form['accept'])
        print(request.form['sex'])
        return "Форма отправлена"
</code></pre>
<p>Заодно давайте настроим нашу форму в&nbsp;style.css, который подключим после стилей Bootstrap:</p>
<pre><code class="language-python">form.login_form {
    margin-left: auto;
    margin-right: auto;
    max-width: 450px;
    background-color: #ffcc00;
    border: 1px solid gray;
    border-radius: 5px;
    padding: 10px;
}
</code></pre>
<p>Если мы&nbsp;все сделали правильно, увидим вот такой впечатляющий результат.</p>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/images/second-year/web/flask-1.png" width="680" height="auto" /></div>
<p>Мы&nbsp;дополнили наш декоратор <code>app.route</code> новым параметром&nbsp;&mdash; списком методов протокола HTTP, с&nbsp;которыми он&nbsp;работает. Всего методов довольно много, но&nbsp;мы&nbsp;будем говорить только о&nbsp;пяти из&nbsp;них:</p>
<ol>
<li>GET&nbsp;&mdash; запрашивает данные, не&nbsp;меняя состояния сервера (&laquo;прочитать&raquo;).</li>
<li>POST&nbsp;&mdash; отправляет данные на&nbsp;сервер (&laquo;отправить&raquo;).</li>
<li>PUT&nbsp;&mdash; заменяет все текущие данные сервера данными запроса (&laquo;заменить&raquo;).</li>
<li>DELETE&nbsp;&mdash; удаляет указанные данные (&laquo;удалить&raquo;).</li>
<li>PATCH&nbsp;&mdash; используется для частичного изменения данных (&laquo;изменить&raquo;).</li>
</ol>
<p>Таким образом, наша функция <var>form_sample</var> работает с&nbsp;двумя методами. Если мы&nbsp;хотим получить данные с&nbsp;сервера, тогда отрабатывает ветка условия, в&nbsp;которой мы&nbsp;отправляем пользователю форму для заполнения. Когда пользователь заполнил форму и&nbsp;нажал на&nbsp;кнопку &laquo;Записаться&raquo;, данные формы заворачиваются в&nbsp;специальный аналог словаря в&nbsp;сущности <var>request</var>, которая хранит всю информацию о&nbsp;пользовательском запросе.</p>
<p>Обратите внимание: поскольку данные формы заворачиваются в&nbsp;аналог словаря, может случиться ситуация, когда по&nbsp;ключу мы&nbsp;не&nbsp;сможем найти значение (например, если пользователь не&nbsp;отметит чекбокс), и&nbsp;тогда выбросится исключение. Чтобы этого избежать, лучше обращаться к&nbsp;данным не&nbsp;напрямую по&nbsp;ключу, а&nbsp;через метод <var>get</var>. Таким образом, более корректная обработка значения чекбокса будет выглядеть так:</p>
<pre><code class="language-python">request.form.get('accept')
</code></pre>
<p>Как вы&nbsp;могли заметить, произошла небольшая странность с&nbsp;приложенным файлом: мы&nbsp;достали только его название, а&nbsp;не&nbsp;содержимое. Это произошло потому, что содержимое файла хранится в&nbsp;другом месте. Давайте напишем еще один пример:</p>
<pre><code class="language-python">@app.route('/sample_file_upload', methods=['POST', 'GET'])
def sample_file_upload():
    if request.method == 'GET':
        return f'''&lt;!doctype html&gt;
                        &lt;html lang="en"&gt;
                          &lt;head&gt;
                            &lt;meta charset="utf-8"&gt;
                            &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
                             &lt;link rel="stylesheet"
                             href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
                             integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
                             crossorigin="anonymous"&gt;
                            &lt;link rel="stylesheet" type="text/css" href="{url_for('static', filename='css/style.css')}" /&gt;
                            &lt;title&gt;Пример загрузки файла&lt;/title&gt;
                          &lt;/head&gt;
                          &lt;body&gt;
                            &lt;h1&gt;Загрузим файл&lt;/h1&gt;
                            &lt;form method="post" enctype="multipart/form-data"&gt;
                               &lt;div class="form-group"&gt;
                                    &lt;label for="photo"&gt;Выберите файл&lt;/label&gt;
                                    &lt;input type="file" class="form-control-file" id="photo" name="file"&gt;
                                &lt;/div&gt;
                                &lt;button type="submit" class="btn btn-primary"&gt;Отправить&lt;/button&gt;
                            &lt;/form&gt;
                          &lt;/body&gt;
                        &lt;/html&gt;'''
    elif request.method == 'POST':
        f = request.files['file']
        print(f.read())
        return "Форма отправлена"
</code></pre>
<div class="material__content-positioner"><img class="material__illustration material__screenshot" src="https://yastatic.net/s3/lyceum/content/image/webserver-2-2.png" width="500" height="auto" /></div>
<p>Обратите внимание: кроме доступа к&nbsp;файлу в&nbsp;<var>request.files</var> мы&nbsp;немного изменили саму разметку формы, добавив в&nbsp;нее параметр</p>
<pre><code class="language-python">enctype="multipart/form-data"
</code></pre>
<p>Иначе форма так и&nbsp;продолжит отправлять только имена файлов, а&nbsp;при попытке доступа к&nbsp;самому файлу мы&nbsp;получим ошибку.</p>
<p>Все достаточно просто, не&nbsp;так&nbsp;ли? Пока самая большая сложность, которая нас преследует&nbsp;&mdash; это громоздкая и&nbsp;неудобная генерация HTML-разметки внутри функции, от&nbsp;этого недостатка мы&nbsp;избавимся уже на&nbsp;следующем уроке.</p>
</section></article>
						</section>
					</div>
				</main>
			</div>
		</div>
<footer class="footer">
	<div class="footer__controls">
		<a rel="noopener noreferrer" target="_blank" class="footer__help-link"
		   href="https://yandex.ru/legal/lms_termsofuse/">Terms of use</a>
	</div>
	<div class="footer__copyright">
		<div>
			<div class="Markdown">
				<div class="paragraph">Generated by <a rel="noopener noreferrer" target="_blank"
				                                       class="footer__help-link"
				                                       href="https://github.com/rodion-gudz/YandexLyceumDocs">Yandex Lyceum Docs</a>
				</div>
			</div>
		</div>
	</div>
</footer>	</div>
	<script src="/js/prism.js"></script>
</body>
</html>